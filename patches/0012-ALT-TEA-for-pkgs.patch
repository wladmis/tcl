From 1db92b2b05820da6572860c63a7a8767ae90d841 Mon Sep 17 00:00:00 2001
From: "Vladimir D. Seleznev" <vseleznv@altlinux.org>
Date: Tue, 8 Oct 2019 18:29:40 +0300
Subject: [PATCH 12/16] ALT TEA for pkgs

---
 tcl/pkgs/itcl4.2.0/Makefile.in             | 15 ++++++++-------
 tcl/pkgs/itcl4.2.0/configure               |  2 +-
 tcl/pkgs/itcl4.2.0/pkgIndex.tcl.in         |  4 ++--
 tcl/pkgs/sqlite3.30.1/Makefile.in          |  4 ++--
 tcl/pkgs/tdbc1.1.1/Makefile.in             | 19 ++++++++++---------
 tcl/pkgs/tdbc1.1.1/configure               |  2 +-
 tcl/pkgs/tdbc1.1.1/pkgIndex.tcl.in         |  2 +-
 tcl/pkgs/tdbcmysql1.1.1/Makefile.in        | 13 +++++++------
 tcl/pkgs/tdbcmysql1.1.1/pkgIndex.tcl.in    |  2 +-
 tcl/pkgs/tdbcmysql1.1.1/tclconfig/tcl.m4   |  2 +-
 tcl/pkgs/tdbcodbc1.1.1/Makefile.in         | 13 +++++++------
 tcl/pkgs/tdbcodbc1.1.1/pkgIndex.tcl.in     |  2 +-
 tcl/pkgs/tdbcpostgres1.1.1/Makefile.in     | 13 +++++++------
 tcl/pkgs/tdbcpostgres1.1.1/pkgIndex.tcl.in |  2 +-
 tcl/pkgs/tdbcsqlite3-1.1.1/Makefile.in     | 13 +++++++------
 tcl/pkgs/thread2.8.5/Makefile.in           | 13 +++++++------
 tcl/pkgs/thread2.8.5/pkgIndex.tcl.in       |  2 +-
 17 files changed, 65 insertions(+), 58 deletions(-)

diff --git a/tcl/pkgs/itcl4.2.0/Makefile.in b/tcl/pkgs/itcl4.2.0/Makefile.in
index ab22866704..00b31d8e16 100644
--- a/tcl/pkgs/itcl4.2.0/Makefile.in
+++ b/tcl/pkgs/itcl4.2.0/Makefile.in
@@ -81,8 +81,8 @@ mandir		= @mandir@
 DESTDIR		=
 
 PKG_DIR		= $(PACKAGE_NAME)$(PACKAGE_VERSION)
-pkgdatadir	= $(datadir)/$(PKG_DIR)
-pkglibdir	= $(libdir)/$(PKG_DIR)
+pkgdatadir	= $(libdir)/tcl/$(PKG_DIR)
+pkglibdir	= $(libdir)/tcl
 pkgincludedir	= $(includedir)/$(PKG_DIR)
 
 top_builddir	= @abs_top_builddir@
@@ -401,6 +401,7 @@ distclean: clean
 #========================================================================
 
 install-lib-binaries: binaries
+	@mkdir -p $(DESTDIR)$(pkglibdir) $(DESTDIR)$(pkgdatadir)
 	@$(INSTALL_DATA_DIR) $(DESTDIR)$(pkglibdir)
 	@list='$(lib_BINARIES)'; for p in $$list; do \
 	  if test -f $$p; then \
@@ -419,15 +420,15 @@ install-lib-binaries: binaries
 	@list='$(PKG_TCL_SOURCES)'; for p in $$list; do \
 	  if test -f $(srcdir)/$$p; then \
 	    destp=`basename $$p`; \
-	    echo " Install $$destp $(DESTDIR)$(pkglibdir)/$$destp"; \
-	    $(INSTALL_DATA) $(srcdir)/$$p $(DESTDIR)$(pkglibdir)/$$destp; \
+	    echo " Install $$destp $(DESTDIR)$(pkgdatadir)/$$destp"; \
+	    $(INSTALL_DATA) $(srcdir)/$$p $(DESTDIR)$(pkgdatadir)/$$destp; \
 	  fi; \
 	done
 	@if test "x$(SHARED_BUILD)" = "x1"; then \
-	    echo " Install pkgIndex.tcl $(DESTDIR)$(pkglibdir)"; \
-	    $(INSTALL_DATA) pkgIndex.tcl $(DESTDIR)$(pkglibdir); \
+	    echo " Install pkgIndex.tcl $(DESTDIR)$(pkgdatadir)"; \
+	    $(INSTALL_DATA) pkgIndex.tcl $(DESTDIR)$(pkgdatadir); \
 	fi
-	$(INSTALL_DATA) itclConfig.sh $(DESTDIR)$(pkglibdir)
+	$(INSTALL_DATA) itclConfig.sh $(DESTDIR)$(libdir)
 
 #========================================================================
 # Install binary executables (e.g. .exe files and dependent .dll files)
diff --git a/tcl/pkgs/itcl4.2.0/configure b/tcl/pkgs/itcl4.2.0/configure
index ce759dae98..05910ea970 100755
--- a/tcl/pkgs/itcl4.2.0/configure
+++ b/tcl/pkgs/itcl4.2.0/configure
@@ -8476,7 +8476,7 @@ $as_echo "${TCLSH_PROG}" >&6; }
     #--------------------------------------------------------------------
 
     # pkglibdir must be a fully qualified path and (not ${exec_prefix}/lib)
-    eval pkglibdir="${libdir}/itcl${PACKAGE_VERSION}"
+    eval pkglibdir="${libdir}/tcl"
     if test "${TCL_LIB_VERSIONS_OK}" = "ok"; then
 	eval itcl_LIB_FLAG="-litcl${PACKAGE_VERSION}${DBGX}"
 	eval itcl_STUB_LIB_FLAG="-litclstub${PACKAGE_VERSION}${DBGX}"
diff --git a/tcl/pkgs/itcl4.2.0/pkgIndex.tcl.in b/tcl/pkgs/itcl4.2.0/pkgIndex.tcl.in
index 0d6ec0eb38..e7d3a95e48 100644
--- a/tcl/pkgs/itcl4.2.0/pkgIndex.tcl.in
+++ b/tcl/pkgs/itcl4.2.0/pkgIndex.tcl.in
@@ -17,5 +17,5 @@
 
 if {![package vsatisfies [package provide Tcl] 8.6]} {return}
 
-package ifneeded itcl @PACKAGE_VERSION@ [list load [file join $dir "@PKG_LIB_FILE@"] itcl]
-package ifneeded Itcl @PACKAGE_VERSION@ [list load [file join $dir "@PKG_LIB_FILE@"] itcl]
+package ifneeded itcl @PACKAGE_VERSION@ [list load [file join $dir .. "@PKG_LIB_FILE@"] itcl]
+package ifneeded Itcl @PACKAGE_VERSION@ [list load [file join $dir .. "@PKG_LIB_FILE@"] itcl]
diff --git a/tcl/pkgs/sqlite3.30.1/Makefile.in b/tcl/pkgs/sqlite3.30.1/Makefile.in
index 196ae0c8f4..6ae745ff26 100644
--- a/tcl/pkgs/sqlite3.30.1/Makefile.in
+++ b/tcl/pkgs/sqlite3.30.1/Makefile.in
@@ -395,8 +395,8 @@ install-lib-binaries: binaries
 	  fi; \
 	done
 	@if test "x$(SHARED_BUILD)" = "x1"; then \
-	    echo " Install pkgIndex.tcl $(DESTDIR)$(pkglibdir)"; \
-	    $(INSTALL_DATA) pkgIndex.tcl $(DESTDIR)$(pkglibdir); \
+	    echo " Install pkgIndex.tcl $(DESTDIR)$(pkgdatadir)"; \
+	    $(INSTALL_DATA) pkgIndex.tcl $(DESTDIR)$(pkgdatadir); \
 	fi
 
 #========================================================================
diff --git a/tcl/pkgs/tdbc1.1.1/Makefile.in b/tcl/pkgs/tdbc1.1.1/Makefile.in
index 4a7665edce..054a06ece7 100644
--- a/tcl/pkgs/tdbc1.1.1/Makefile.in
+++ b/tcl/pkgs/tdbc1.1.1/Makefile.in
@@ -79,8 +79,8 @@ mandir		= @mandir@
 DESTDIR		=
 
 PKG_DIR		= $(PACKAGE_NAME)$(PACKAGE_VERSION)
-pkgdatadir	= $(datadir)/$(PKG_DIR)
-pkglibdir	= $(libdir)/$(PKG_DIR)
+pkgdatadir	= $(libdir)/tcl/$(PKG_DIR)
+pkglibdir	= $(libdir)/tcl
 pkgincludedir	= $(includedir)/$(PKG_DIR)
 
 top_builddir	= @abs_top_builddir@
@@ -425,6 +425,7 @@ distclean: clean
 #========================================================================
 
 install-lib-binaries: binaries
+	@mkdir -p $(DESTDIR)$(pkglibdir) $(DESTDIR)$(pkgdatadir)
 	@$(INSTALL_DATA_DIR) $(DESTDIR)$(pkglibdir)
 	@list='$(lib_BINARIES)'; for p in $$list; do \
 	  if test -f $$p; then \
@@ -434,7 +435,7 @@ install-lib-binaries: binaries
 	    if test "x$$ext" = "xdll"; then \
 		lib=`basename $$p|sed -e 's/.[^.]*$$//'`.lib; \
 		if test -f $$lib; then \
-		    echo " $(INSTALL_DATA) $$lib $(DESTDIR)$(pkglibdir)/$$lib"; \
+		    echo " $(INSTALL_DATA) $$lib $(DESTDIR)$(pkgdir)/$$lib"; \
 	            $(INSTALL_DATA) $$lib $(DESTDIR)$(pkglibdir)/$$lib; \
 		fi; \
 	    fi; \
@@ -443,16 +444,16 @@ install-lib-binaries: binaries
 	@list='$(PKG_TCL_SOURCES)'; for p in $$list; do \
 	  if test -f $(srcdir)/$$p; then \
 	    destp=`basename $$p`; \
-	    echo " Install $$destp $(DESTDIR)$(pkglibdir)/$$destp"; \
-	    $(INSTALL_DATA) $(srcdir)/$$p $(DESTDIR)$(pkglibdir)/$$destp; \
+	    echo " Install $$destp $(DESTDIR)$(pkgdatadir)/$$destp"; \
+	    $(INSTALL_DATA) $(srcdir)/$$p $(DESTDIR)$(pkgdatadir)/$$destp; \
 	  fi; \
 	done
 	@if test "x$(SHARED_BUILD)" = "x1"; then \
-	    echo " Install pkgIndex.tcl $(DESTDIR)$(pkglibdir)"; \
-	    $(INSTALL_DATA) pkgIndex.tcl $(DESTDIR)$(pkglibdir); \
+	    echo " Install pkgIndex.tcl $(DESTDIR)$(pkgdatadir)"; \
+	    $(INSTALL_DATA) pkgIndex.tcl $(DESTDIR)$(pkgdatadir); \
 	fi
-	@echo " Install tdbcConfig.sh $(DESTDIR)$(pkglibdir)"; \
-	$(INSTALL_DATA) tdbcConfig.sh $(DESTDIR)$(pkglibdir)/tdbcConfig.sh
+	@echo " Install tdbcConfig.sh $(DESTDIR)$(libdir)"; \
+	$(INSTALL_DATA) tdbcConfig.sh $(DESTDIR)$(libdir)/tdbcConfig.sh
 
 #========================================================================
 # Install binary executables (e.g. .exe files and dependent .dll files)
diff --git a/tcl/pkgs/tdbc1.1.1/configure b/tcl/pkgs/tdbc1.1.1/configure
index bf9c81d280..25345193a1 100755
--- a/tcl/pkgs/tdbc1.1.1/configure
+++ b/tcl/pkgs/tdbc1.1.1/configure
@@ -8560,7 +8560,7 @@ fi
     #--------------------------------------------------------------------
 
     # pkglibdir must be a fully qualified path and (not ${exec_prefix}/lib)
-    eval pkglibdir="${libdir}/tdbc${PACKAGE_VERSION}"
+    eval pkglibdir="${libdir}/tcl"
     if test "${TCL_LIB_VERSIONS_OK}" = "ok"; then
 	eval tdbc_LIB_FLAG="-ltdbc${PACKAGE_VERSION}${DBGX}"
 	eval tdbc_STUB_LIB_FLAG="-ltdbcstub${PACKAGE_VERSION}${DBGX}"
diff --git a/tcl/pkgs/tdbc1.1.1/pkgIndex.tcl.in b/tcl/pkgs/tdbc1.1.1/pkgIndex.tcl.in
index 379635b7ca..16aba89b76 100644
--- a/tcl/pkgs/tdbc1.1.1/pkgIndex.tcl.in
+++ b/tcl/pkgs/tdbc1.1.1/pkgIndex.tcl.in
@@ -13,6 +13,6 @@ apply {{dir} {
     }
     package ifneeded @PACKAGE_NAME@ @PACKAGE_VERSION@ \
 	"package require TclOO @TCLOO_VERSION_REQ@-;\
-	[list load [file join $dir @PKG_LIB_FILE@] @PACKAGE_NAME@]\;\
+	[list load [file join $dir .. @PKG_LIB_FILE@] @PACKAGE_NAME@]\;\
 	[list source $libraryfile]"
 }} $dir
diff --git a/tcl/pkgs/tdbcmysql1.1.1/Makefile.in b/tcl/pkgs/tdbcmysql1.1.1/Makefile.in
index 3d74fac7a1..93cbcaa2f8 100644
--- a/tcl/pkgs/tdbcmysql1.1.1/Makefile.in
+++ b/tcl/pkgs/tdbcmysql1.1.1/Makefile.in
@@ -79,8 +79,8 @@ mandir		= @mandir@
 DESTDIR		=
 
 PKG_DIR		= $(PACKAGE_NAME)$(PACKAGE_VERSION)
-pkgdatadir	= $(datadir)/$(PKG_DIR)
-pkglibdir	= $(libdir)/$(PKG_DIR)
+pkgdatadir	= $(libdir)/tcl/$(PKG_DIR)
+pkglibdir	= $(libdir)/tcl
 pkgincludedir	= $(includedir)/$(PKG_DIR)
 
 top_builddir	= @abs_top_builddir@
@@ -421,6 +421,7 @@ distclean: clean
 #========================================================================
 
 install-lib-binaries: binaries
+	@mkdir -p $(DESTDIR)$(pkglibdir) $(DESTDIR)$(pkgdatadir)
 	@$(INSTALL_DATA_DIR) $(DESTDIR)$(pkglibdir)
 	@list='$(lib_BINARIES)'; for p in $$list; do \
 	  if test -f $$p; then \
@@ -439,13 +440,13 @@ install-lib-binaries: binaries
 	@list='$(PKG_TCL_SOURCES)'; for p in $$list; do \
 	  if test -f $(srcdir)/$$p; then \
 	    destp=`basename $$p`; \
-	    echo " Install $$destp $(DESTDIR)$(pkglibdir)/$$destp"; \
-	    $(INSTALL_DATA) $(srcdir)/$$p $(DESTDIR)$(pkglibdir)/$$destp; \
+	    echo " Install $$destp $(DESTDIR)$(pkgdatadir)/$$destp"; \
+	    $(INSTALL_DATA) $(srcdir)/$$p $(DESTDIR)$(pkgdatadir)/$$destp; \
 	  fi; \
 	done
 	@if test "x$(SHARED_BUILD)" = "x1"; then \
-	    echo " Install pkgIndex.tcl $(DESTDIR)$(pkglibdir)"; \
-	    $(INSTALL_DATA) pkgIndex.tcl $(DESTDIR)$(pkglibdir); \
+	    echo " Install pkgIndex.tcl $(DESTDIR)$(pkgdatadir)"; \
+	    $(INSTALL_DATA) pkgIndex.tcl $(DESTDIR)$(pkgdatadir); \
 	fi
 
 #========================================================================
diff --git a/tcl/pkgs/tdbcmysql1.1.1/pkgIndex.tcl.in b/tcl/pkgs/tdbcmysql1.1.1/pkgIndex.tcl.in
index 3365c76abf..235b773937 100644
--- a/tcl/pkgs/tdbcmysql1.1.1/pkgIndex.tcl.in
+++ b/tcl/pkgs/tdbcmysql1.1.1/pkgIndex.tcl.in
@@ -5,4 +5,4 @@ if {[catch {package require Tcl @TCL_VERSION_REQ@}]} {
 }
 package ifneeded tdbc::mysql @PACKAGE_VERSION@ \
     "[list source [file join $dir @PACKAGE_NAME@.tcl]]\;\
-    [list load [file join $dir @PKG_LIB_FILE@] @PACKAGE_NAME@]"
+    [list load [file join $dir .. @PKG_LIB_FILE@] @PACKAGE_NAME@]"
diff --git a/tcl/pkgs/tdbcmysql1.1.1/tclconfig/tcl.m4 b/tcl/pkgs/tdbcmysql1.1.1/tclconfig/tcl.m4
index 21e8f25403..f519cfdc4c 100644
--- a/tcl/pkgs/tdbcmysql1.1.1/tclconfig/tcl.m4
+++ b/tcl/pkgs/tdbcmysql1.1.1/tclconfig/tcl.m4
@@ -3876,7 +3876,7 @@ AC_DEFUN([TEA_EXPORT_CONFIG], [
     #--------------------------------------------------------------------
 
     # pkglibdir must be a fully qualified path and (not ${exec_prefix}/lib)
-    eval pkglibdir="[$]{libdir}/$1${PACKAGE_VERSION}"
+    eval pkglibdir="[$]{libdir}/tcl"
     if test "${TCL_LIB_VERSIONS_OK}" = "ok"; then
 	eval $1_LIB_FLAG="-l$1${PACKAGE_VERSION}${DBGX}"
 	eval $1_STUB_LIB_FLAG="-l$1stub${PACKAGE_VERSION}${DBGX}"
diff --git a/tcl/pkgs/tdbcodbc1.1.1/Makefile.in b/tcl/pkgs/tdbcodbc1.1.1/Makefile.in
index 85d07b5720..435228a36e 100644
--- a/tcl/pkgs/tdbcodbc1.1.1/Makefile.in
+++ b/tcl/pkgs/tdbcodbc1.1.1/Makefile.in
@@ -79,8 +79,8 @@ mandir		= @mandir@
 DESTDIR		=
 
 PKG_DIR		= $(PACKAGE_NAME)$(PACKAGE_VERSION)
-pkgdatadir	= $(datadir)/$(PKG_DIR)
-pkglibdir	= $(libdir)/$(PKG_DIR)
+pkgdatadir	= $(libdir)/tcl/$(PKG_DIR)
+pkglibdir	= $(libdir)/tcl
 pkgincludedir	= $(includedir)/$(PKG_DIR)
 
 top_builddir	= @abs_top_builddir@
@@ -433,6 +433,7 @@ distclean: clean
 #========================================================================
 
 install-lib-binaries: binaries
+	@mkdir -p $(DESTDIR)$(pkglibdir) $(DESTDIR)$(pkgdatadir)
 	@$(INSTALL_DATA_DIR) $(DESTDIR)$(pkglibdir)
 	@list='$(lib_BINARIES)'; for p in $$list; do \
 	  if test -f $$p; then \
@@ -451,13 +452,13 @@ install-lib-binaries: binaries
 	@list='$(PKG_TCL_SOURCES)'; for p in $$list; do \
 	  if test -f $(srcdir)/$$p; then \
 	    destp=`basename $$p`; \
-	    echo " Install $$destp $(DESTDIR)$(pkglibdir)/$$destp"; \
-	    $(INSTALL_DATA) $(srcdir)/$$p $(DESTDIR)$(pkglibdir)/$$destp; \
+	    echo " Install $$destp $(DESTDIR)$(pkgdatadir)/$$destp"; \
+	    $(INSTALL_DATA) $(srcdir)/$$p $(DESTDIR)$(pkgdatadir)/$$destp; \
 	  fi; \
 	done
 	@if test "x$(SHARED_BUILD)" = "x1"; then \
-	    echo " Install pkgIndex.tcl $(DESTDIR)$(pkglibdir)"; \
-	    $(INSTALL_DATA) pkgIndex.tcl $(DESTDIR)$(pkglibdir); \
+	    echo " Install pkgIndex.tcl $(DESTDIR)$(pkgdatadir)"; \
+	    $(INSTALL_DATA) pkgIndex.tcl $(DESTDIR)$(pkgdatadir); \
 	fi
 
 #========================================================================
diff --git a/tcl/pkgs/tdbcodbc1.1.1/pkgIndex.tcl.in b/tcl/pkgs/tdbcodbc1.1.1/pkgIndex.tcl.in
index 98522cac4d..1496cbf330 100644
--- a/tcl/pkgs/tdbcodbc1.1.1/pkgIndex.tcl.in
+++ b/tcl/pkgs/tdbcodbc1.1.1/pkgIndex.tcl.in
@@ -5,4 +5,4 @@ if {[catch {package require Tcl @TCL_VERSION_REQ@}]} {
 }
 package ifneeded tdbc::odbc @PACKAGE_VERSION@ \
     "[list source [file join $dir @PACKAGE_NAME@.tcl]]\;\
-    [list load [file join $dir @PKG_LIB_FILE@] @PACKAGE_NAME@]"
+    [list load [file join $dir .. @PKG_LIB_FILE@] @PACKAGE_NAME@]"
diff --git a/tcl/pkgs/tdbcpostgres1.1.1/Makefile.in b/tcl/pkgs/tdbcpostgres1.1.1/Makefile.in
index 72b7996d21..dc0a529402 100644
--- a/tcl/pkgs/tdbcpostgres1.1.1/Makefile.in
+++ b/tcl/pkgs/tdbcpostgres1.1.1/Makefile.in
@@ -79,8 +79,8 @@ mandir		= @mandir@
 DESTDIR		=
 
 PKG_DIR		= $(PACKAGE_NAME)$(PACKAGE_VERSION)
-pkgdatadir	= $(datadir)/$(PKG_DIR)
-pkglibdir	= $(libdir)/$(PKG_DIR)
+pkgdatadir	= $(libdir)/tcl/$(PKG_DIR)
+pkglibdir	= $(libdir)/tcl
 pkgincludedir	= $(includedir)/$(PKG_DIR)
 
 top_builddir	= @abs_top_builddir@
@@ -423,6 +423,7 @@ distclean: clean
 #========================================================================
 
 install-lib-binaries: binaries
+	@mkdir -p $(DESTDIR)$(pkglibdir) $(DESTDIR)$(pkgdatadir)
 	@$(INSTALL_DATA_DIR) $(DESTDIR)$(pkglibdir)
 	@list='$(lib_BINARIES)'; for p in $$list; do \
 	  if test -f $$p; then \
@@ -441,13 +442,13 @@ install-lib-binaries: binaries
 	@list='$(PKG_TCL_SOURCES)'; for p in $$list; do \
 	  if test -f $(srcdir)/$$p; then \
 	    destp=`basename $$p`; \
-	    echo " Install $$destp $(DESTDIR)$(pkglibdir)/$$destp"; \
-	    $(INSTALL_DATA) $(srcdir)/$$p $(DESTDIR)$(pkglibdir)/$$destp; \
+	    echo " Install $$destp $(DESTDIR)$(pkgdatadir)/$$destp"; \
+	    $(INSTALL_DATA) $(srcdir)/$$p $(DESTDIR)$(pkgdatadir)/$$destp; \
 	  fi; \
 	done
 	@if test "x$(SHARED_BUILD)" = "x1"; then \
-	    echo " Install pkgIndex.tcl $(DESTDIR)$(pkglibdir)"; \
-	    $(INSTALL_DATA) pkgIndex.tcl $(DESTDIR)$(pkglibdir); \
+	    echo " Install pkgIndex.tcl $(DESTDIR)$(pkgdatadir)"; \
+	    $(INSTALL_DATA) pkgIndex.tcl $(DESTDIR)$(pkgdatadir); \
 	fi
 
 #========================================================================
diff --git a/tcl/pkgs/tdbcpostgres1.1.1/pkgIndex.tcl.in b/tcl/pkgs/tdbcpostgres1.1.1/pkgIndex.tcl.in
index 0999069ff0..d6f9b8faa6 100644
--- a/tcl/pkgs/tdbcpostgres1.1.1/pkgIndex.tcl.in
+++ b/tcl/pkgs/tdbcpostgres1.1.1/pkgIndex.tcl.in
@@ -5,4 +5,4 @@ if {[catch {package require Tcl @TCL_VERSION_REQ@}]} {
 }
 package ifneeded tdbc::postgres @PACKAGE_VERSION@ \
     "[list source [file join $dir @PACKAGE_NAME@.tcl]]\;\
-    [list load [file join $dir @PKG_LIB_FILE@] @PACKAGE_NAME@]"
+    [list load [file join $dir .. @PKG_LIB_FILE@] @PACKAGE_NAME@]"
diff --git a/tcl/pkgs/tdbcsqlite3-1.1.1/Makefile.in b/tcl/pkgs/tdbcsqlite3-1.1.1/Makefile.in
index 106b1b0e19..b65ef37547 100644
--- a/tcl/pkgs/tdbcsqlite3-1.1.1/Makefile.in
+++ b/tcl/pkgs/tdbcsqlite3-1.1.1/Makefile.in
@@ -79,8 +79,8 @@ mandir		= @mandir@
 DESTDIR		=
 
 PKG_DIR		= $(PACKAGE_NAME)-$(PACKAGE_VERSION)
-pkgdatadir	= $(datadir)/$(PKG_DIR)
-pkglibdir	= $(libdir)/$(PKG_DIR)
+pkgdatadir	= $(libdir)/tcl/$(PKG_DIR)
+pkglibdir	= $(libdir)/tcl
 pkgincludedir	= $(includedir)/$(PKG_DIR)
 
 top_builddir	= @abs_top_builddir@
@@ -403,6 +403,7 @@ distclean: clean
 #========================================================================
 
 install-lib-binaries: binaries
+	@mkdir -p $(DESTDIR)$(pkglibdir) $(DESTDIR)$(pkgdatadir)
 	@$(INSTALL_DATA_DIR) $(DESTDIR)$(pkglibdir)
 	@list='$(lib_BINARIES)'; for p in $$list; do \
 	  if test -f $$p; then \
@@ -421,13 +422,13 @@ install-lib-binaries: binaries
 	@list='$(PKG_TCL_SOURCES)'; for p in $$list; do \
 	  if test -f $(srcdir)/$$p; then \
 	    destp=`basename $$p`; \
-	    echo " Install $$destp $(DESTDIR)$(pkglibdir)/$$destp"; \
-	    $(INSTALL_DATA) $(srcdir)/$$p $(DESTDIR)$(pkglibdir)/$$destp; \
+	    echo " Install $$destp $(DESTDIR)$(pkgdatadir)/$$destp"; \
+	    $(INSTALL_DATA) $(srcdir)/$$p $(DESTDIR)$(pkgdatadir)/$$destp; \
 	  fi; \
 	done
 	@if test "x$(SHARED_BUILD)" = "x1"; then \
-	    echo " Install pkgIndex.tcl $(DESTDIR)$(pkglibdir)"; \
-	    $(INSTALL_DATA) pkgIndex.tcl $(DESTDIR)$(pkglibdir); \
+	    echo " Install pkgIndex.tcl $(DESTDIR)$(pkgdatadir)"; \
+	    $(INSTALL_DATA) pkgIndex.tcl $(DESTDIR)$(pkgdatadir); \
 	fi
 
 #========================================================================
diff --git a/tcl/pkgs/thread2.8.5/Makefile.in b/tcl/pkgs/thread2.8.5/Makefile.in
index 0a1a1067fa..1355ab6199 100644
--- a/tcl/pkgs/thread2.8.5/Makefile.in
+++ b/tcl/pkgs/thread2.8.5/Makefile.in
@@ -79,8 +79,8 @@ mandir		= @mandir@
 DESTDIR		=
 
 PKG_DIR		= $(PACKAGE_NAME)$(PACKAGE_VERSION)
-pkgdatadir	= $(datadir)/$(PKG_DIR)
-pkglibdir	= $(libdir)/$(PKG_DIR)
+pkgdatadir	= $(libdir)/tcl/$(PKG_DIR)
+pkglibdir	= $(libdir)/tcl
 pkgincludedir	= $(includedir)/$(PKG_DIR)
 
 top_builddir	= .
@@ -386,6 +386,7 @@ distclean: clean
 #========================================================================
 
 install-lib-binaries: binaries
+	@mkdir -p $(DESTDIR)$(pkglibdir) $(DESTDIR)$(pkgdatadir)
 	@$(INSTALL_DATA_DIR) $(DESTDIR)$(pkglibdir)
 	@list='$(lib_BINARIES)'; for p in $$list; do \
 	  if test -f $$p; then \
@@ -412,13 +413,13 @@ install-lib-binaries: binaries
 	@list='$(PKG_TCL_SOURCES)'; for p in $$list; do \
 	  if test -f $(srcdir)/$$p; then \
 	    destp=`basename $$p`; \
-	    echo " Install $$destp $(DESTDIR)$(pkglibdir)/$$destp"; \
-	    $(INSTALL_DATA) $(srcdir)/$$p $(DESTDIR)$(pkglibdir)/$$destp; \
+	    echo " Install $$destp $(DESTDIR)$(pkgdatadir)/$$destp"; \
+	    $(INSTALL_DATA) $(srcdir)/$$p $(DESTDIR)$(pkgdatadir)/$$destp; \
 	  fi; \
 	done
 	@if test "x$(SHARED_BUILD)" = "x1"; then \
-	    echo " Install pkgIndex.tcl $(DESTDIR)$(pkglibdir)"; \
-	    $(INSTALL_DATA) pkgIndex.tcl $(DESTDIR)$(pkglibdir); \
+	    echo " Install pkgIndex.tcl $(DESTDIR)$(pkgdatadir)"; \
+	    $(INSTALL_DATA) pkgIndex.tcl $(DESTDIR)$(pkgdatadir); \
 	fi
 
 #========================================================================
diff --git a/tcl/pkgs/thread2.8.5/pkgIndex.tcl.in b/tcl/pkgs/thread2.8.5/pkgIndex.tcl.in
index 22f5f8ff47..a2efb503e3 100644
--- a/tcl/pkgs/thread2.8.5/pkgIndex.tcl.in
+++ b/tcl/pkgs/thread2.8.5/pkgIndex.tcl.in
@@ -23,7 +23,7 @@ if {![package vsatisfies [package provide Tcl] 8.4]} {
 # about a thread-disabled interp, instead of the message
 # "can't find package Thread".
 
-package ifneeded Thread @PACKAGE_VERSION@ [list load [file join $dir @PKG_LIB_FILE@]]
+package ifneeded Thread @PACKAGE_VERSION@ [list load [file join $dir .. @PKG_LIB_FILE@]]
 
 # package Ttrace uses some support machinery.
 
-- 
2.21.0


From ad49fc2a82e4e1cb9ade949a5eac7816a007540c Mon Sep 17 00:00:00 2001
From: "Vladimir D. Seleznev" <vseleznv@altlinux.org>
Date: Wed, 9 Oct 2019 17:49:53 +0300
Subject: [PATCH 16/16] ALT pkgs soname

---
 tcl/pkgs/itcl4.2.0/configure         | 2 +-
 tcl/pkgs/tdbc1.1.1/configure         | 2 +-
 tcl/pkgs/tdbcmysql1.1.1/configure    | 2 +-
 tcl/pkgs/tdbcodbc1.1.1/configure     | 2 +-
 tcl/pkgs/tdbcpostgres1.1.1/configure | 2 +-
 tcl/pkgs/tdbcsqlite3-1.1.1/configure | 2 +-
 tcl/pkgs/thread2.8.5/configure       | 2 +-
 7 files changed, 7 insertions(+), 7 deletions(-)

diff --git a/tcl/pkgs/itcl4.2.0/configure b/tcl/pkgs/itcl4.2.0/configure
index 36362d6ca2..7419d690d6 100755
--- a/tcl/pkgs/itcl4.2.0/configure
+++ b/tcl/pkgs/itcl4.2.0/configure
@@ -6856,7 +6856,7 @@ fi
 
 	    # TEA specific: use LDFLAGS_DEFAULT instead of LDFLAGS
 	    SHLIB_LD='${CC} ${CFLAGS} ${LDFLAGS_DEFAULT} -shared'
-	    LDFLAGS="$LDFLAGS -Wl,--export-dynamic"
+	    LDFLAGS="$LDFLAGS -Wl,--export-dynamic,-soname,\${@}"
 	    if test $doRpath = yes; then :
 
 		CC_SEARCH_FLAGS='-Wl,-rpath,${LIB_RUNTIME_DIR}'
diff --git a/tcl/pkgs/tdbc1.1.1/configure b/tcl/pkgs/tdbc1.1.1/configure
index 25345193a1..2a7f66d7cc 100755
--- a/tcl/pkgs/tdbc1.1.1/configure
+++ b/tcl/pkgs/tdbc1.1.1/configure
@@ -6969,7 +6969,7 @@ fi
 
 	    # TEA specific: use LDFLAGS_DEFAULT instead of LDFLAGS
 	    SHLIB_LD='${CC} ${CFLAGS} ${LDFLAGS_DEFAULT} -shared'
-	    LDFLAGS="$LDFLAGS -Wl,--export-dynamic"
+	    LDFLAGS="$LDFLAGS -Wl,--export-dynamic,-soname,\${@}"
 	    if test $doRpath = yes; then :
 
 		CC_SEARCH_FLAGS='-Wl,-rpath,${LIB_RUNTIME_DIR}'
diff --git a/tcl/pkgs/tdbcmysql1.1.1/configure b/tcl/pkgs/tdbcmysql1.1.1/configure
index c68fd06159..ea4b716d54 100755
--- a/tcl/pkgs/tdbcmysql1.1.1/configure
+++ b/tcl/pkgs/tdbcmysql1.1.1/configure
@@ -7313,7 +7313,7 @@ fi
 
 	    # TEA specific: use LDFLAGS_DEFAULT instead of LDFLAGS
 	    SHLIB_LD='${CC} ${CFLAGS} ${LDFLAGS_DEFAULT} -shared'
-	    LDFLAGS="$LDFLAGS -Wl,--export-dynamic"
+	    LDFLAGS="$LDFLAGS -Wl,--export-dynamic,-soname,\${@}"
 	    if test $doRpath = yes; then :
 
 		CC_SEARCH_FLAGS='-Wl,-rpath,${LIB_RUNTIME_DIR}'
diff --git a/tcl/pkgs/tdbcodbc1.1.1/configure b/tcl/pkgs/tdbcodbc1.1.1/configure
index 9a19bf1003..ec5e754ed2 100755
--- a/tcl/pkgs/tdbcodbc1.1.1/configure
+++ b/tcl/pkgs/tdbcodbc1.1.1/configure
@@ -7313,7 +7313,7 @@ fi
 
 	    # TEA specific: use LDFLAGS_DEFAULT instead of LDFLAGS
 	    SHLIB_LD='${CC} ${CFLAGS} ${LDFLAGS_DEFAULT} -shared'
-	    LDFLAGS="$LDFLAGS -Wl,--export-dynamic"
+	    LDFLAGS="$LDFLAGS -Wl,--export-dynamic,-soname,\${@}"
 	    if test $doRpath = yes; then :
 
 		CC_SEARCH_FLAGS='-Wl,-rpath,${LIB_RUNTIME_DIR}'
diff --git a/tcl/pkgs/tdbcpostgres1.1.1/configure b/tcl/pkgs/tdbcpostgres1.1.1/configure
index 08e0e177d8..4e0b8550bf 100755
--- a/tcl/pkgs/tdbcpostgres1.1.1/configure
+++ b/tcl/pkgs/tdbcpostgres1.1.1/configure
@@ -7313,7 +7313,7 @@ fi
 
 	    # TEA specific: use LDFLAGS_DEFAULT instead of LDFLAGS
 	    SHLIB_LD='${CC} ${CFLAGS} ${LDFLAGS_DEFAULT} -shared'
-	    LDFLAGS="$LDFLAGS -Wl,--export-dynamic"
+	    LDFLAGS="$LDFLAGS -Wl,--export-dynamic,-soname,\${@}"
 	    if test $doRpath = yes; then :
 
 		CC_SEARCH_FLAGS='-Wl,-rpath,${LIB_RUNTIME_DIR}'
diff --git a/tcl/pkgs/tdbcsqlite3-1.1.1/configure b/tcl/pkgs/tdbcsqlite3-1.1.1/configure
index 88d10d34b2..7a4ad052ce 100755
--- a/tcl/pkgs/tdbcsqlite3-1.1.1/configure
+++ b/tcl/pkgs/tdbcsqlite3-1.1.1/configure
@@ -5653,7 +5653,7 @@ fi
 
 	    # TEA specific: use LDFLAGS_DEFAULT instead of LDFLAGS
 	    SHLIB_LD='${CC} ${CFLAGS} ${LDFLAGS_DEFAULT} -shared'
-	    LDFLAGS="$LDFLAGS -Wl,--export-dynamic"
+	    LDFLAGS="$LDFLAGS -Wl,--export-dynamic,-soname,\${@}"
 	    if test $doRpath = yes; then :
 
 		CC_SEARCH_FLAGS='-Wl,-rpath,${LIB_RUNTIME_DIR}'
diff --git a/tcl/pkgs/thread2.8.5/configure b/tcl/pkgs/thread2.8.5/configure
index 4ac6e586be..09bcd7f28a 100755
--- a/tcl/pkgs/thread2.8.5/configure
+++ b/tcl/pkgs/thread2.8.5/configure
@@ -6869,7 +6869,7 @@ fi
 
 	    # TEA specific: use LDFLAGS_DEFAULT instead of LDFLAGS
 	    SHLIB_LD='${CC} ${CFLAGS} ${LDFLAGS_DEFAULT} -shared'
-	    LDFLAGS="$LDFLAGS -Wl,--export-dynamic"
+	    LDFLAGS="$LDFLAGS -Wl,--export-dynamic,-soname,\${@}"
 	    if test $doRpath = yes; then :
 
 		CC_SEARCH_FLAGS='-Wl,-rpath,${LIB_RUNTIME_DIR}'
-- 
2.21.0

